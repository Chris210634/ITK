]ITK: The Insight Segmentation and Registration Toolkit
======================================================


Links
-----

* [Homepage](https://itk.org)
* [Download](https://itk.org/ITK/resources/software.html)
* [Mailing List](https://itk.org/ITK/help/mailing.html)
* [Book](https://itk.org/ITK/help/book.html)
* [Help](https://itk.org/ITK/help/help.html)
* [Examples](https://itk.org/ITKExamples/)
* [Bugtracker](https://issues.itk.org/)
* [Submit a patch](CONTRIBUTING.md)


About
-----

The National Library of Medicine Insight Segmentation and Registration Toolkit
(ITK), or Insight Toolkit, is an open-source, cross-platform C++ toolkit for
segmentation and registration. Segmentation is the process of identifying and
classifying  data found in a digitally sampled representation. Typically the
sampled representation is an image acquired from such medical instrumentation
as CT or MRI scanners. Registration is the task of aligning or developing
correspondences between data. For example, in the medical environment, a
CT scan may be aligned with a MRI scan in order to combine the information
contained in both.

The toolkit may be built from source using [CMake](https://cmake.org).


Copyright
---------

The [Insight Software Consortium](http://www.insightsoftwareconsortium.org)
holds the copyright of this software. This is a non-profit entity that
promotes the use of ITK for educational and research purposes. ITK is
distributed under a license that enables use for both non-commercial and
commercial applications. See [LICENSE](https://github.com/InsightSoftwareConsortium/ITK/blob/master/LICENSE)
and [NOTICE](https://github.com/InsightSoftwareConsortium/ITK/blob/master/NOTICE)
files for details.


About this fork
---------------

This fork of ITK is a process parallelized implementation of ITK. This allows ITK to be massively
parallelized across deifferent machines which share a common directory.


Development Information
-----------------------

Only the following modules have been parallelized:

 - itkResampleImageFilter
 - itkBinaryFunctorImageFilter
 - VectorNeighborhoodOperatorImageFilter
 - InvertDisplacementFieldImageFilter
 - ComposeDisplacementFieldImageFilter
 - MattesMutualInformationMetric
 - ANTSCorrelationMetric

MultiThreader, DomainThreader and ImageSource have been modified for process parallelized execution.
MultiThreader contains useful MPI-styled functions for process parallelization:

 - Get ifstream - Get the input file stream for file to write data
 - Get Ofstream - Get the output file stream to read data from other processes
 - Barrer - All processes must get here before proceeeding so everyone's on the same page.
 - Sync - Synchronize data across all processes. Sync takes data at the indicated address of
   process 0 and braodcasts it to other processses. All other processes overwrite their value
   with value from process 0. This is useful for synchronizing value of seeds for random 
   number generator and decimal values that might drift.

The basic workflow of threaded execution is as follows:

 - Before Threaded execution and threaded execution is unchanged from before, except that 
   each process executes over the region assigned to their process number.
 - After threaded execution, each process write the results from their calulation into file
   and wait for all other processes to finish. 
 - When all processes are finished, each process reads all other processses' data.
 - Wait again for all processes to finish.
 - After threaded execution is not changed from threaded ITK. This step is executed simulataneously
   in all processes and combines the outputs from the regions into one output.

The process parallelization relies on the entire program being deterministic.

All processes/modules which are not process parallelized will be executed in every process
simulataneously. The expectation is that every process will be identical so that when
the program reaches a parallel portion, the processes will still be in sync.

In order to parallelize a process inherited from ImageSource or DomainThreader, follow these steps:
 1) Implement WriteProcessDataToFile(). This function must write all the data generated during 
    ThreadedExecution() for its region to file.
 2) Implement ReadProcessDataFromFile(). This function must fetch all data generated by other
    processes and read them into memory.
 3) Override IsProcessParallelized() to return true.


Installation Information
------------------------

Following standard ITK installation should install threaded ITK (as expected).
To install process parallelized ITK, set enviornmental variable ITK_PROCESS_PARALLELIZE to 1

use 

export ITK_PROCESS_PARALLELIZE=1
